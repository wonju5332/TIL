# TIL-001

## 오늘 한 일
* PartronBand SDK 연동작업
  * 오늘 고민한 내용은 아래와 같다.
  * SDK에서 제공하는 싱글톤 객체의 manager가 있는데, 회사에서는 이 객체를 컴파일 소스에서 사용하지 않고, 회사 프레임웍에 포함시켜서 사용하게끔 하려고 한다.
  * 현재 자사 프레임웍의 경우, 컴파일단의 소스가 아닌, 프리컴파일하여 직접 .framework파일을 폴더에 붙여넣기하여 사용하는 방식으로 사용해야 한다.
  * 사실 결과만 얻으면 되기 때문에 어떻게 사용해도 상관은 없지만, 불편한 점이 있었다.
    * 첫째, 에러처리가 곤란했다.
    엡에서 밴드에게 심박수 데이터를 요청할 경우, 데이터가 없으면 Error객체를 담아 Completion Handler에서 description을 통해 에러 내용을 알 수 있다. 그런데, 회사 프레임웍은 아래와 같이 두가지 파라메터로 값을 전달해야하는 구조로 되어 있어, 불필요한 처리를 해야하는 점이 잇었다.
    ```Swift
    func onProcessStatus(state:Int, data:String){
      Switch state{
        case .Connect:
        case .Disconnect:
        case .HeartRateData:
        ...
      }
    }
    ```
    * 둘째, 뭔가 번거롭고, 귀찮고, 불필요한 작업처럼 느껴진다. 위처럼, 모든 스테이터스별 데이터를 저 델리게이트로 보내야하기 때문에, 사용하기 편한 custom object가 있음에도 불구하고, string으로 변환해서..넘겨서..다시 파싱해서.. 등등..

* 밴드세팅화면 구현
  * 디자인
    * 안드로이드쪽 화면이 먼저 나왔다. On/Off 스위치가 있는 설정과, 2~4개정도의 선택지가 있는 설정 등 크게 2가지 타입이었다.
    * 최대한 쿠퍼티노 디자인으로 구현해보고자했다.
    * 테이블뷰를 사용하기로 했고, 셀의 스타일을 애플에서 범용적으로 사용하는 인디게이터를 사용했다.
    * 아이폰의 설정탭을 많이 참고하였는데, 자세히 보다보니까 공통점이 있었다.
      * 섹션의 header ttle은 거의 사용하지 않는 듯 하다.
      * 섹션의 footer에는 설정을 설명하는 글들을 작은 포인트로 표시해두었다.
      * 설정값이 복수개인 경우에는, 선택했을 때 예상으로는 PickerView를 사용하지 않았을까? 했지만, 그냥 선택해서 화면 전환 후, 테이블뷰에 선택할 아이템 목록을 다시 나타내는 방식으로 되어있다.
      (아마 PickerView는 날짜를 고르거나, 나이를 입력하거나 등...할 때 사용하나보다. 그러고보면 요즘 PickerView를 사용하는 앱을 많이 보지못한것 같다.).
* 병렬 프로그래밍
  * 병렬구조와 비동기에 대해서 검색해보았었다.
  3가지 종류의 데이터가 있는데, 서버에 저장하기 위한 Post API가 종류별로 있었다.
  따라서 1) 데이터를 요청한 후 2) 데이터 정제한 후 3) 서버에 보내기 등 위 3단계를 총 3개 데이터에 한 해 반복해야 했다.
  * 이걸 동기처리하게되면, 성능이 체감이 될 지는 확신하지 못했으나, 비효율적이라고 생각했다.
  * 그래서 각 작업을 병렬로 동시에 시작하고, 3개 작업 중 마지막 작업이 끝나는 시점에 맞춰 화면처리를 하고자 했다.

  * 결과적으로는, 해당 기능을 활용하지 못한 상태로 마무리지어졌다.

```Swift
dispatchqueue.global() //
dispatchqueue.main() // main thread
```
